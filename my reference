#include <iostream>
#include <iomanip>
using namespace std;

//For "GLOBAL VARIABLES and ARRAYS"
    //Arrays
string ownerCreds[2] = {"admin", "admin"};
string dates[7] = {"Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"};
bool isBusy[7] = {false,false,false,false,false,false,false};

    //Variables

bool firstLogin = 1;
//End for "GLOBAL"


//For input errors
void clearInput(){
    cin.clear();
    cin.ignore(10000, '\n');
}

void displayDates() {
    cout << "Available dates are:\n";
    for (int i = 0; i < 7; i++) {
        cout << "[" << i + 1 << "] " << dates[i];
        if (isBusy[i]) {
            cout << "\tBusy";
        }
        cout << endl;
    }
}

//CLI Title
void header(string title) {

    cout << "============================================================\n";
    cout << setw(47) << title << endl;
    cout << "============================================================\n\n";
}

//CLI Sub choices 1
void mainMenuUI(){
    cout << setw(26) <<"[1]  "<< "Customer\n";
    cout << setw(26) <<"[2]  "<< "Owner\n";
    cout << setw(26) <<"[3]  "<< "Exit\n";
}
//CLI Sub choices 2
void ownerMenuUI(){
    cout << setw(26) <<"[1]  "<< "Return to Main Menu\n";
    cout << setw(26) <<"[2]  "<< "Set Working Days\n";
    cout << setw(26) <<"[3]  "<< "View Available Dates\n";
}

void makeReservation() {
    int pick;

    while (true) {
        system("clear");
        header("MAKE RESERVATION");
        displayDates();

        cout << "\nPick a date: ";
        if (!(cin >> pick)) {
            clearInput();
            continue;
        }

        if (pick < 1 || pick > 7) {
            system("clear");
            cout << "Invalid choice.\n";
            continue;
        }

        // If date is busy
        if (isBusy[pick - 1]) {
            system("clear");
            header("MAKE RESERVATION");
            displayDates();
            cout << "\n" << dates[pick - 1]
                 << " is not available please select another date.\n";
            continue;
        }

        // Reserve date
        isBusy[pick - 1] = true;

        cout << "\nReservation successful!\n";
        cout << "Scheduled on: " << dates[pick - 1] << endl;
        cout << "Press enter to continue...";
        cin.ignore();
        cin.get();
        break;
    }
}




//CLI Sub choices 3
void customerMenuUI() {
    cout << setw(26) <<"[1]  "<< "Return to Main Menu\n";
    cout << setw(26) <<"[2]  "<< "Make Reservation\n";
}

//Owner CLI
bool ownerLogin(){
    string user, pass;

    system("clear");
    header("OWNER LOGIN");

    if (firstLogin){
        cout << "Default Login Credentials:\n";
        cout << "Username: admin\n";
        cout << "Password: admin\n\n";
    }

    cout << "Enter Username: ";
    cin >> user;
    cout << "Enter Password: ";
    cin >> pass;

    if (user == ownerCreds[0] && pass == ownerCreds[1]){
        firstLogin = false;
        return true;
    }

    cout << "\nInvalid username or password.\n";
    cout << "Press enter to return...";
    cin.ignore();
    cin.get();
    return false;
}


void ownerMenu() {
    int choice = 0;

    while (choice != 1) {
        system("clear");
        header("OWNER PANEL");
        ownerMenuUI();

        cout << "\nEnter choice: ";

        //for invalid user input
        if (!(cin >> choice)){
            clearInput();
            choice = 0;
        }

         else if (choice == 2) {
            cout << "\nSetting working days...\n";
            cout << "Enter 1 to return: ";
            cin >> choice;
        }

        else if (choice == 3) {
            cout << "\nViewing available dates...\n";
            cout << "Enter 1 to return: ";
            cin >> choice;
        }
    }
}




//Customer CLI
void customerMenu() {
    int choice = 0;

    while (choice != 1) {
        system("clear");
        header("CUSTOMER PANEL");
        customerMenuUI();

        cout << "\nEnter choice: ";

        if (!(cin >> choice)) {
            clearInput();
            choice = 0;
        }

        if (choice == 2) {
            makeReservation();
            choice = 0; // stay in customer menu
        }
    }
}




//First CLI
int main() {
    int choice = 0;

    while (choice != 3){
        system("clear");
        header("VEHICLE SERVICE RESERVATION SYSTEM");
        mainMenuUI();

        cout << "\nEnter choice: ";

        //for invalid user input
        if (!(cin >> choice)){
            clearInput();
            choice = 0;
        }

        if(choice == 1){
            customerMenu();
        }
        else if (choice == 2){
            ownerMenu();
        }
        else if (choice == 3){
            system("clear");
            header("VEHICLE SERVICE RESERVATION SYSTEM");
            cout << "Ending Program...\n";
        }
    }

    return 0;
}
